# Upload Server

Цей проєкт — сервер для завантаження, збереження та управління зображеннями через REST API. Файли зберігаються у локальну папку та в PostgreSQL базу даних через PgBouncer. Підтримується обмеження за розміром файлу та дозволені формати (.jpg, .jpeg, .png, .gif).  

## Структура проєкту

- `src/app.py` — основний FastAPI додаток з маршрутами для завантаження, перегляду та видалення файлів.  
- `src/db/repositories.py` — робота з PostgreSQL, створення та отримання записів про зображення.  
- `src/db/dto.py` — DTO для файлів (`ImageDTO`, `ImageDetailsDTO`).  
- `src/dto/file.py` — DTO для завантажених файлів (`UploadedFileDTO`).  
- `src/handlers/files.py` — обробка файлів, збереження у папку, перевірка формату та розміру.  
- `src/settings/config.py` — основні налаштування: директорія для файлів, максимальний розмір, підтримувані формати, налаштування БД.  
- `src/settings/logging_config.py` — налаштування логування.  
- `docker-compose.yml` — конфігурація для запуску сервера і PostgreSQL через Docker.  
- `images/` — папка для збереження завантажених файлів (створюється автоматично).

## Налаштування

Основні параметри у `src/settings/config.py`:
- `IMAGE_DIR` — директорія для збереження файлів.  
- `MAX_FILE_SIZE` — максимальний розмір файлу в байтах (наприклад, 5 MB).  
- `SUPPORTED_FORMATS` — дозволені формати файлів.  
- Параметри підключення до БД (`DB_HOST`, `DB_PORT`, `DB_USER`, `DB_PASSWORD`, `DB_NAME`).

Щоб змінити максимальний розмір файлу або формати — редагуйте `MAX_FILE_SIZE` та `SUPPORTED_FORMATS`. Щоб змінити папку збереження — редагуйте `IMAGE_DIR`.

## Встановлення та запуск

1. Клонувати репозиторій:  
```bash
git clone https://github.com/username/upload-server.git
cd upload-server
Запустити Docker Compose:


Копіювати код
docker-compose up --build
Сервер буде доступний за адресою http://localhost.
Папка images/ буде автоматично створена для збереження файлів.

Використання API
Healthcheck: GET / повертає повідомлення, що сервер працює.

Завантаження файлу: POST /upload/ з параметром file. Повертає дані файлу (ім’я, оригінальне ім’я, розмір, тип, URL).

Список файлів: GET /upload/?page=1&per_page=10&order=desc повертає список з пагінацією.

Деталі файлу: GET /upload/{filename} повертає інформацію по конкретному файлу.

Видалення файлу: DELETE /upload/{filename} видаляє файл з диску та БД.

Логування
Логи ведуться через logging_config.py. Логуються завантаження, видалення файлів та помилки.